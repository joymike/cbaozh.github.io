

<!-- saved from url=(0052)https://joymike.github.io/cbaozh.github.io/test.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<title>CORS jQuery Plugin</title>
</head>

<body>
	<script src="https://code.jquery.com/jquery-1.8.3.min.js" integrity="sha256-YcbK69I5IXQftf/mYD8WY0/KmEDCv1asggHpJk1trM8=" crossorigin="anonymous"></script>
	<script>
		function NoCors() {
			var username = $("#u1").val();
			var password = $("#p1").val();

			// var payload = "data: {\r\n  \"key1\": \"cbateam\",\r\n  \"key2\": \" " + password + "\"\r\n}";
			// console.log(payload);
			var url =
			"https://ozharvest.crittah.com/webapi/oauth/token";
			console.log(url);
			var settings = {
				"url": url,
				"type": "POST",
				"data": "grant_type=password&password=" + encodeURIComponent(password) + "&username=" + encodeURIComponent(username),
				"timeout": 0,
				"headers": {
					"Content-Type": "text/plain"
				},
			};

			$.ajax(settings).done(function (response) {
				console.log(response);
				$("#resultsOutput").html(JSON.stringify(response, null, 4));
			}).fail(function (jqXHR, textStatus, errorThrown){

				if (jqXHR.responseText) {
					$("#resultsOutput").html(JSON.stringify(JSON.parse(jqXHR.responseText), null, 4));
				}
		    });;
		}
	</script>
	<input type="text" id="u1" value="username"><br>
	<input type="text" id="p1" value="XXXXXX">
	<input type="button" onclick="NoCors()" value="Submit">

<div id="resultsOutput"> </div>

</body></html>